---
config:
  layout: elk
---
classDiagram
direction TB
    class Menu {
        +Menu(IMenuRenderer*, IMenuInputHandler*)
        +reload()
        +update() AppState
    }

    class IMenuRenderer {
        +render_menu_frame()*
        +render_menu(MenuTitle)*
    }

    class IMenuInputHandler {
        +scan() int*
        +~IMenuInputHandler()*
    }

    class MenuRenderer {
        +MenuRenderer(IPlatformRenderer*, TextRenderer, BlockRenderer)
    }

    class IPlatformRenderer {
        +clear()*
        +show_cursor()*
        +hide_cursor()*
        +set_cursor(Pos)*
        +set_cursor(int x, int y)*
        +set_color(Color)*
        +set_color(Color foreground, Color background)*
        +print_s(const char* const, Color)*
        +print_s(const char* const, Color foreground, Color background)*
        +print_s(std::string, Color)*
        +print_s(std::string s, Color foreground, Color background)*
        +print_s(std::string)*
    }

    class TextRenderer {
        +TextRenderer(IPlatformRenderer*, ColorPicker)
        +print_big_char(Pos, char, Color)
        +print_big_char(Pos, char, Color foreground, Color background)
        +print_big_char(Pos, char)
        +print_big_string(Pos, std::string&, Color)
        +print_big_string(Pos, std::string&, Color foreground, Color background)
        +print_big_string(Pos, std::string&)
        +print_big_string(Pos pos, const char* str, Color key)
        +print_big_string(Pos, const char*)
        +print_small_string(Pos, std::string&, Color)
        +print_small_string(Pos, std::string&)
        +print_small_string(Pos pos, const char* str)
        +draw_game_start_count(Pos pos, int count)
        +draw_game_over(Pos pos)
        +draw_logo(Pos pos)
    }

    class BlockRenderer {
        +BlockRenderer(IPlatformRenderer*, ColorPicker)
        +render_mino_pattern(Pos, const Tetromino&, bool transparent = false)
        +render_mino_pattern(Pos, const Tetromino&, Color, bool transparent = false)
        +render_mino_pattern(Pos pos, const Tetromino& tetromino, Color mino_color, Color background_color, bool transparent = false)   
    }

    class ColorPicker {
        +ColorPicker()
        +get_random_color() Color
        +get_block_color(int type) std::string
        +get_block_color(const Tetromino& tetromino) std::string
        +get_color_key(const Tetromino& tetromino) Color
        +get_color_key(int type) Color
    }

    class ConsoleRenderer {
        
    }

    <<interface>> IPlatformRenderer

    Menu o-- IMenuRenderer
    Menu o-- IMenuInputHandler

    IMenuInputHandler <|-- LinuxInput
    IMenuInputHandler <|-- WindowInput 

    IMenuRenderer <|-- MenuRenderer

    IPlatformRenderer <|-- ConsoleRenderer 

    MenuRenderer o-- IPlatformRenderer
    MenuRenderer o-- TextRenderer
    MenuRenderer o-- BlockRenderer

    BlockRenderer o-- IPlatformRenderer
    BlockRenderer o-- ColorPicker

    TextRenderer o-- IPlatformRenderer
    TextRenderer o-- ColorPicker